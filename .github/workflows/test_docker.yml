name: Build

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    paths:
      - "**.tex"
      - "**.yml"
    branches: [ master ]
  pull_request:
    paths:
      - "**.tex"
      - "**.yml"
    branches: [ master ]
  

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build_latex"
  build_and_run_tests:
    name: Build all files
    runs-on: ubuntu-latest
    # container:
    #   image: xucheng/texlive-small:latest
    # defaults:
    #   run:
    #     shell: sh
    steps:
      - name: Set up repo
        uses: actions/checkout@v2
      - name: Install missing packages
        uses: docker://xucheng/texlive-small:latest
        with:
          # entrypoint: /bin/sh
          args: tlmgr install silence appendixnumberbeamer
        # run: |
        #   tlmgr install silence
        #   tlmgr install appendixnumberbeamer
        #   tlmgr install graphics
      - name: Build minimal examples
        uses: docker://xucheng/texlive-small:latest
        with:
          # entrypoint: /bin/sh
          args: latexmk -pdf -file-line-error -interaction=nonstopmode demo.tex
